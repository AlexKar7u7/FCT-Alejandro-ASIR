{% load static %}
<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Registrarse</title>
  <link rel="stylesheet" href="{% static 'blog/auth.css' %}">
  <link rel="stylesheet" href="{% static 'blog/static.css' %}">
</head>

<body>
  <button id="theme-toggle" class="btn btn-link nav-link" aria-label="Toggle theme">ðŸŒ™</button>
  <div class="login-container">
    <h1>Crear cuenta</h1>

    {% if form.non_field_errors %}
      <p class="error">{{ form.non_field_errors|join:', ' }}</p>
    {% endif %}

    <form method="post">
      {% csrf_token %}
      {{ form }}
      <button type="submit">Registrarse</button>
    </form>
    <p>Â¿Ya tienes cuenta? <a href="{% url 'login' %}">Inicia sesiÃ³n aquÃ­.</a></p>
    <p><a href="{% url 'inicio' %}">Volver al inicio</a></p>
  </div>
  </div>
  <script>
    (function () {
      const toggle = document.getElementById('theme-toggle');
      const root = document.documentElement;
      const body = document.body;

      function updateButton(theme) {
        if (theme === 'dark') {
          toggle.textContent = 'â˜€ï¸';
          toggle.setAttribute('aria-pressed', 'true');
        } else {
          toggle.textContent = 'ðŸŒ™';
          toggle.setAttribute('aria-pressed', 'false');
        }
      }

      function applyTheme(theme, persist = true) {
        if (theme === 'dark') {
          root.classList.add('dark');
          body.classList.add('dark-mode');
        } else {
          root.classList.remove('dark');
          body.classList.remove('dark-mode');
        }
        updateButton(theme);
        if (persist) localStorage.setItem('theme', theme);
      }

      const saved = localStorage.getItem('theme');
      if (saved === 'dark' || saved === 'light') {
        applyTheme(saved, false);
      } else {
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        applyTheme(prefersDark ? 'dark' : 'light', false);
      }

      toggle.addEventListener('click', () => {
        const isDark = root.classList.toggle('dark');
        body.classList.toggle('dark-mode', isDark);
        applyTheme(isDark ? 'dark' : 'light');
      });
    })();
  </script>
</body>
</html>